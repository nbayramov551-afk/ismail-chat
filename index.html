<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PHANTOM V30 - Gƒ∞ZLƒ∞ KANAL</title>
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        :root { --main-glow: #00ff41; --danger: #ff003c; --bg: #050505; }
        body { background: var(--bg); color: var(--main-glow); font-family: 'Consolas', monospace; margin: 0; overflow: hidden; height: 100vh; }
        
        /* Gƒ∞Rƒ∞≈û EKRANI - MATRIX STYLE */
        #login { position: fixed; inset: 0; z-index: 1000; background: radial-gradient(circle, #0a1a0a 0%, #000 100%); display: flex; align-items: center; justify-content: center; }
        .terminal { border: 2px solid var(--main-glow); padding: 30px; width: 320px; text-align: center; box-shadow: 0 0 30px rgba(0,255,65,0.2); background: rgba(0,0,0,0.9); border-radius: 5px; position: relative; overflow: hidden; }
        .terminal::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: var(--main-glow); animation: scanline 3s linear infinite; }
        @keyframes scanline { 0% { top: 0; } 100% { top: 100%; } }

        input { background: #000; border: 1px solid #004400; color: var(--main-glow); padding: 15px; width: 100%; margin: 10px 0; outline: none; border-radius: 3px; font-size: 14px; box-sizing: border-box; }
        input:focus { border-color: var(--main-glow); box-shadow: 0 0 10px var(--main-glow); }
        
        .btn-start { width: 100%; padding: 15px; background: var(--main-glow); color: #000; font-weight: 900; border: none; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s; }
        .btn-start:hover { background: #fff; box-shadow: 0 0 20px var(--main-glow); }

        /* RADAR Sƒ∞STEMƒ∞ */
        #radar { position: fixed; inset: 0; z-index: 500; background: #000; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .scanner { width: 150px; height: 150px; border: 2px solid var(--danger); border-radius: 50%; position: relative; display: flex; align-items: center; justify-content: center; }
        .scanner::after { content: ""; width: 100%; height: 100%; border-radius: 50%; border: 2px solid var(--danger); position: absolute; animation: pulse 1s infinite; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(1.8); opacity: 0; } }

        /* ∆èSAS G√ñR√úNT√ú */
        #main-ui { display: none; width: 100vw; height: 100vh; position: relative; }
        #remote-video { width: 100%; height: 100%; object-fit: cover; filter: contrast(1.1) brightness(1.1); }
        #local-video { position: absolute; bottom: 110px; right: 20px; width: 120px; height: 170px; border: 2px solid var(--main-glow); border-radius: 8px; object-fit: cover; z-index: 10; box-shadow: 0 0 15px #000; }

        /* KOMANDA PANELƒ∞ */
        .emoji-bar { position: absolute; top: 50%; right: 15px; transform: translateY(-50%); display: flex; flex-direction: column; gap: 15px; z-index: 20; }
        .e-btn { font-size: 30px; background: rgba(0,0,0,0.8); border: 1px solid var(--main-glow); border-radius: 10px; width: 55px; height: 55px; color: #fff; cursor: pointer; transition: 0.2s; }
        .e-btn:active { transform: scale(0.8); background: var(--main-glow); }

        .controls { position: absolute; bottom: 35px; left: 50%; transform: translateX(-50%); display: flex; gap: 20px; z-index: 20; background: rgba(0,0,0,0.9); padding: 15px 35px; border-radius: 100px; border: 1px solid var(--main-glow); box-shadow: 0 0 20px rgba(0,255,65,0.3); }
        .c-btn { width: 50px; height: 50px; border-radius: 50%; border: none; background: #111; color: #fff; font-size: 22px; cursor: pointer; }
        .c-btn.active { color: var(--danger); }

        /* Gƒ∞ZLƒ∞ EMOJƒ∞ U√áU≈ûU */
        .float-emoji { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 120px; z-index: 100; animation: ghostFly 1.5s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards; pointer-events: none; }
        @keyframes ghostFly { 0% { opacity: 0; transform: translate(-50%, 0%) scale(0.5); } 50% { opacity: 1; } 100% { opacity: 0; transform: translate(-50%, -300%) scale(2); } }
    </style>
</head>
<body>

    <div id="login">
        <div class="terminal">
            <h2 style="margin:0; letter-spacing:5px;">PHANTOM V30</h2>
            <p style="font-size: 9px; color: #555; margin-bottom:20px;">ENCRYPTED P2P TUNNEL PRO v3.0</p>
            <input type="password" id="tk" placeholder="Gƒ∞ZLƒ∞ ≈ûƒ∞FR∆è (TOKEN)">
            <input type="text" id="rm" placeholder="TUNEL ADI (OTAQ)">
            <button class="btn-start" onclick="ignite('A')">Sƒ∞QNAL G√ñND∆èR (AZ)</button>
            <button class="btn-start" onclick="ignite('B')" style="margin-top:10px; background:#002200; color:#0f0; border:1px solid #0f0;">Sƒ∞QNALLI TUT (RU)</button>
        </div>
    </div>

    <div id="radar">
        <div class="scanner">
            <i class="fas fa-user-secret" style="font-size: 40px; color: var(--danger);"></i>
        </div>
        <p style="color:var(--danger); margin-top:30px; font-weight:bold; letter-spacing:3px; animation: blink 0.5s infinite;">DE≈ûƒ∞LM∆è BA≈ûLADI...</p>
    </div>

    <div id="main-ui">
        <video id="remote-video" playsinline autoplay></video>
        <video id="local-video" autoplay muted playsinline></video>
        <div class="emoji-bar" id="emoji-list"></div>
        <div class="controls">
            <button class="c-btn" onclick="toggleMute(this)"><i class="fas fa-microphone"></i></button>
            <button class="c-btn" onclick="toggleCam(this)"><i class="fas fa-video"></i></button>
            <button class="c-btn" onclick="location.reload()" style="background:#222;"><i class="fas fa-bolt"></i></button>
            <button class="c-btn" onclick="exitSession()" style="background:var(--danger);"><i class="fas fa-power-off"></i></button>
        </div>
    </div>

    <script>
        let peer, localStream, activeConn, role, targetID, myID;
        const PHANTOM_SERVER = 'phantom-server-hwhx.onrender.com';

        async function ignite(sel) {
            role = sel;
            const tk = document.getElementById('tk').value;
            const rm = document.getElementById('rm').value;
            if(!tk || !rm) return;

            document.getElementById('login').style.display = 'none';
            document.getElementById('radar').style.display = 'flex';

            // ULTRA ENCRYPTION: ID-l…ôri kims…ô t…ôxmin ed…ô bilm…ôsin
            const salt = "phantom_99_";
            const secretHash = CryptoJS.SHA256(tk + salt + rm).toString().substring(0, 15);
            myID = (role === 'A' ? 'UP-' : 'DOWN-') + secretHash;
            targetID = (role === 'A' ? 'DOWN-' : 'UP-') + secretHash;

            try {
                localStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: {ideal: 1280}, height: {ideal: 720}, frameRate: 30 }, 
                    audio: { echoCancellation: true, noiseSuppression: true } 
                });
                document.getElementById('local-video').srcObject = localStream;

                peer = new Peer(myID, {
                    host: PHANTOM_SERVER,
                    port: 443,
                    path: '/',
                    secure: true,
                    debug: 0, // Konsola he√ß n…ô yazmƒ±r, iz buraxmƒ±r
                    config: { 'iceServers': [{ 'urls': 'stun:stun.l.google.com:19302' }, { 'urls': 'stun:stun3.l.google.com:19302' }] }
                });

                peer.on('open', () => {
                    // Aqressiv Baƒülantƒ± Modu: H…ôr 2 saniy…ôd…ôn bir tuneli yoxlayƒ±r
                    const tunnelBlaster = setInterval(() => {
                        if (document.getElementById('main-ui').style.display === 'none') {
                            const call = peer.call(targetID, localStream);
                            if(call) setupRemote(call);
                            const conn = peer.connect(targetID, {reliable: true});
                            if(conn) activeConn = conn;
                        } else {
                            // Baƒülantƒ± quruldusa, partlayƒ±≈üƒ± dayandƒ±r
                            // clearInterval(tunnelBlaster); 
                        }
                    }, 2000);
                });

                peer.on('call', call => {
                    call.answer(localStream);
                    setupRemote(call);
                });

                peer.on('connection', conn => {
                    activeConn = conn;
                    conn.on('data', d => { if(d.type==='e') showEmoji(d.v); });
                });

                peer.on('error', () => { /* Ban yedikd…ô sakitc…ô fon i≈üin…ô davam et */ });

            } catch(e) { alert("KRƒ∞Tƒ∞K X∆èTA: Kameraya icaz…ô yoxdur!"); location.reload(); }
        }

        function setupRemote(call) {
            call.on('stream', stream => {
                const rv = document.getElementById('remote-video');
                rv.srcObject = stream;
                document.getElementById('radar').style.display = 'none';
                document.getElementById('main-ui').style.display = 'block';
                rv.play().catch(() => { window.onclick = () => rv.play(); });
            });
        }

        function showEmoji(v) {
            const div = document.createElement('div');
            div.className = 'float-emoji';
            div.innerText = v;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 1400);
        }

        const emojis = ['‚ù§Ô∏è','üòò','üî•','üîû','üíé','üòà','üëë','üö®'];
        const list = document.getElementById('emoji-list');
        emojis.forEach(e => {
            const b = document.createElement('button');
            b.className = 'e-btn';
            b.innerText = e;
            b.onclick = () => {
                showEmoji(e);
                if(activeConn) activeConn.send({type:'e', v:e});
            };
            list.appendChild(b);
        });

        function toggleMute(btn) {
            const state = localStream.getAudioTracks()[0].enabled = !localStream.getAudioTracks()[0].enabled;
            btn.classList.toggle('active', !state);
            btn.innerHTML = state ? '<i class="fas fa-microphone"></i>' : '<i class="fas fa-microphone-slash"></i>';
        }
        function toggleCam(btn) {
            const state = localStream.getVideoTracks()[0].enabled = !localStream.getVideoTracks()[0].enabled;
            btn.classList.toggle('active', !state);
            btn.innerHTML = state ? '<i class="fas fa-video"></i>' : '<i class="fas fa-video-slash"></i>';
        }
        function exitSession() {
            if(confirm("Tunel baƒülansƒ±n?")) window.location.href = "https://google.com";
        }
    </script>
</body>
</html>


