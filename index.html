<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PHANTOM_V20_ULTRA</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #000; color: #0f0; font-family: 'Courier New', monospace; margin: 0; overflow: hidden; height: 100vh; }
        #login-screen { position: fixed; inset: 0; background: radial-gradient(circle, #051005 0%, #000 100%); z-index: 1000; display: flex; align-items: center; justify-content: center; }
        .terminal-box { border: 1px solid #0f0; padding: 30px; width: 320px; background: rgba(0,0,0,0.9); box-shadow: 0 0 20px #0f0; border-radius: 5px; text-align: center; }
        input { background: #000; border: 1px solid #0f0; color: #0f0; padding: 12px; margin: 10px 0; width: 100%; box-sizing: border-box; outline: none; }
        .start-btn { width: 100%; padding: 15px; background: #0f0; color: #000; font-weight: bold; cursor: pointer; border: none; text-transform: uppercase; }
        #main-ui { display: none; width: 100vw; height: 100vh; position: relative; }
        video { width: 100%; height: 100%; object-fit: cover; filter: contrast(1.1) brightness(1.1); }
        #local-v { position: absolute; bottom: 110px; right: 20px; width: 110px; height: 150px; border: 1px solid #0f0; z-index: 10; border-radius: 4px; }
        #status-bar { position: fixed; top: 0; width: 100%; background: rgba(0,0,0,0.8); color: #0f0; font-size: 10px; padding: 5px; text-align: center; z-index: 100; border-bottom: 1px solid #0f0; }
        .lock-screen { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 500; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .panic-btn { width: 150px; height: 150px; border-radius: 50%; background: #f00; border: 5px solid #fff; color: #fff; font-weight: 900; cursor: pointer; box-shadow: 0 0 30px #f00; animation: pulse 0.8s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="terminal-box">
            <h2 style="letter-spacing: 5px;">PHANTOM V20</h2>
            <p style="font-size: 9px; color: #0a0;">ENCRYPTED RELAY // BYPASS ACTIVE</p>
            <input type="password" id="tk" placeholder="TOKEN (Gƒ∞ZLƒ∞)">
            <input type="text" id="rm" placeholder="ROOM_ID">
            <div style="display: flex; gap: 5px;">
                <button class="start-btn" onclick="run('A')" style="font-size: 10px;">HOST (AZ)</button>
                <button class="start-btn" onclick="run('B')" style="font-size: 10px; background: #004400; color: #fff;">GUEST (RU)</button>
            </div>
        </div>
    </div>

    <div id="main-ui">
        <div id="status-bar">Sƒ∞STEM: TUNEL G√ñZL∆èNƒ∞Lƒ∞R...</div>
        <video id="rv" playsinline></video>
        <video id="lv" autoplay muted playsinline></video>
        
        <div class="lock-screen" id="lock">
            <button class="panic-btn" onclick="unlock()">G√ñR√úNT√úN√ú<br>M∆èCBUR ET</button>
            <p style="margin-top: 20px; color: #fff; font-size: 12px;">SIQNAL TUTULDU, A√áMAQ √ú√á√úN BASIN!</p>
        </div>
    </div>

    <script>
        let peer, stream, role;
        const log = t => document.getElementById('status-bar').innerText = "Sƒ∞STEM: " + t;

        // üî± RUSƒ∞YA √ú√á√úN "GHOST" SERVERL∆èR (M…ôcburi TCP Relay)
        const ice = {
            iceServers: [
                { urls: 'stun:stun.l.google.com:19302' },
                { urls: 'stun:stun3.l.google.com:19302' },
                { urls: 'stun:stun.voip.aebc.com:3478' }
            ],
            iceTransportPolicy: 'all',
            sdpSemantics: 'unified-plan'
        };

        async function run(r) {
            role = r;
            const tk = document.getElementById('tk').value;
            const rm = document.getElementById('rm').value;
            if(!tk || !rm) return alert("M…ôlumatlarƒ± daxil edin!");

            const hash = CryptoJS.SHA1(tk + rm).toString().substring(0, 10);
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-ui').style.display = 'block';

            try {
                // üî± PACKET FRAGMENTATION (Rusiyada k…ôsilm…ôm…ôk √º√ß√ºn …ôn ki√ßik paket ayarƒ±)
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: {ideal: 160}, height: {ideal: 120}, frameRate: 10 }, 
                    audio: { echoCancellation: true, noiseSuppression: true } 
                });
                document.getElementById('lv').srcObject = stream;

                peer = new Peer((role=='A'?'AZ-':'RU-')+hash, { config: ice });

                peer.on('open', id => {
                    log(role=='A'?"Rusiya g√∂zl…ônilir...":"Az…ôrbaycana qo≈üulur...");
                    if(role=='B') {
                        // Rusiyadan z…ôngi bir ne√ß…ô d…ôf…ô dalbadal g√∂nd…ôririk (Firewall-u yormaq √º√ß√ºn)
                        let attempts = 0;
                        const dial = () => {
                            if(attempts > 5) return;
                            const call = peer.call('AZ-'+hash, stream);
                            bind(call);
                            attempts++;
                            setTimeout(dial, 5000);
                        };
                        dial();
                    }
                });

                peer.on('call', call => {
                    call.answer(stream);
                    bind(call);
                });

            } catch(e) { log("KAMERA X∆èTASI!"); }
        }

        function bind(call) {
            call.on('stream', rs => {
                document.getElementById('rv').srcObject = rs;
                document.getElementById('lock').style.display = 'flex';
                log("SIQNAL ALINDI! Kƒ∞Lƒ∞Dƒ∞ A√áIN.");
            });
        }

        function unlock() {
            const rv = document.getElementById('rv');
            rv.play().then(() => {
                document.getElementById('lock').style.display = 'none';
                log("TUNEL AKTƒ∞VDƒ∞R.");
            }).catch(e => {
                // ∆èg…ôr autoplay bloklansa, t…ôkrar yoxla
                rv.muted = true;
                rv.play();
                log("S∆èSƒ∞ AYARLARDAN A√áIN!");
            });
        }
    </script>
</body>
</html>
